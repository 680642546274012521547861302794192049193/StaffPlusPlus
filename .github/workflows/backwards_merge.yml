# This workflow will build a package using Maven and then publish it to GitHub packages when a release is created
# For more information see: https://github.com/actions/setup-java#apache-maven-with-a-settings-path

name: Maven Package

on:
    push:
        branches: [ master ]
    pull_request:
        branches: [ master ]

jobs:
    build:

        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v2
            - name: Declare some variables
              id: vars
              shell: bash
              run: |
                  echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"
                  echo "::set-output name=sha_short::$(git rev-parse --short HEAD)"

#           ============  1.13   =====================
            - uses: actions/checkout@v2
              with:
                  ref: release/1.13.0

            - name: Commit files
              shell: bash
              run: git cherry-pick -m 1 ${{ steps.vars.outputs.sha_short }}

            -   name: Push changes
                uses: ad-m/github-push-action@master
                with:
                    github_token: ${{ secrets.GITHUB_TOKEN }}
                    branch: release/1.13.0

#           ============  1.14   =====================
            - uses: actions/checkout@v2
              with:
                  ref: release/1.14.0

            - name: Commit files
              shell: bash
              run: git cherry-pick -m 1 ${{ steps.vars.outputs.sha_short }}

            -   name: Push changes
                uses: ad-m/github-push-action@master
                with:
                    github_token: ${{ secrets.GITHUB_TOKEN }}
                    branch: release/1.14.0

#           ============  1.15   =====================
            - uses: actions/checkout@v2
              with:
                  ref: release/1.14.0

            - name: Commit files
              shell: bash
              run: git cherry-pick -m 1 ${{ steps.vars.outputs.sha_short }}

            -   name: Push changes
                uses: ad-m/github-push-action@master
                with:
                    github_token: ${{ secrets.GITHUB_TOKEN }}
                    branch: release/1.14.0

#           ============  1.16   =====================
            - uses: actions/checkout@v2
              with:
                  ref: release/1.14.0

            - name: Commit files
              shell: bash
              run: git cherry-pick -m 1 ${{ steps.vars.outputs.sha_short }}

            -   name: Push changes
                uses: ad-m/github-push-action@master
                with:
                    github_token: ${{ secrets.GITHUB_TOKEN }}
                    branch: release/1.14.0